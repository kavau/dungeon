{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "append_css",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"echo '\n#message-log {\n    position: absolute;\n    bottom: 20px;\n    right: 20px;\n    width: 400px;\n    max-height: 250px;\n    overflow-y: hidden;\n    background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%);\n    padding: 10px;\n    color: #eee;\n    font-size: 14px;\n    z-index: 100;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-end;\n    pointer-events: none;\n}\n\n.log-entry {\n    margin-bottom: 5px;\n    text-shadow: 1px 1px 2px #000;\n    opacity: 0;\n    animation: fadeIn 0.3s forwards;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(10px); }\n    to { opacity: 1; transform: translateY(0); }\n}\n\n.log-entry.combat { color: #ff6666; }\n.log-entry.player-hit { color: #ff3333; font-weight: bold; }\n.log-entry.monster-die { color: #ffaa00; font-weight: bold; }\n.log-entry.item { color: #ffff00; }\n.log-entry.torch { color: #ffcc00; }\n.log-entry.door { color: #aaaaff; }\n' >> style.css"
			],
			"isBackground": false,
			"problemMatcher": [],
			"group": "build"
		},
		{
			"label": "append_css",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"cat >> style.css <<EOF\n\n#intro-screen {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.9);\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    z-index: 300;\n    color: #e0e0e0;\n    text-align: center;\n    padding: 40px;\n}\n\n#intro-screen h1 {\n    font-size: 48px;\n    color: #ffaa00;\n    margin-bottom: 30px;\n    text-shadow: 0 0 10px rgba(255, 170, 0, 0.5);\n    font-family: 'Courier New', monospace;\n    letter-spacing: 2px;\n}\n\n#intro-screen p {\n    font-size: 18px;\n    max-width: 800px;\n    margin-bottom: 20px;\n    line-height: 1.6;\n    color: #ccc;\n}\n\n#intro-screen .highlight {\n    color: #ff4444;\n    font-weight: bold;\n    font-size: 22px;\n    margin-top: 20px;\n    text-shadow: 0 0 5px rgba(255, 68, 68, 0.3);\n}\n\n#intro-screen .press-key {\n    margin-top: 50px;\n    font-size: 20px;\n    color: #fff;\n    animation: pulse 1.5s infinite;\n}\n\n@keyframes pulse {\n    0% { opacity: 0.5; }\n    50% { opacity: 1; }\n    100% { opacity: 0.5; }\n}\nEOF\n"
			],
			"isBackground": false,
			"problemMatcher": [],
			"group": "none"
		},
		{
			"label": "append_win_css",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"cat >> style.css <<EOF\n\n#win-screen {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.9);\n    display: none;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    z-index: 300;\n    color: #e0e0e0;\n    text-align: center;\n    padding: 40px;\n}\n\n#win-screen h1 {\n    font-size: 48px;\n    color: #44ff44;\n    margin-bottom: 30px;\n    text-shadow: 0 0 10px rgba(68, 255, 68, 0.5);\n    font-family: 'Courier New', monospace;\n    letter-spacing: 2px;\n}\n\n#win-screen p {\n    font-size: 18px;\n    max-width: 800px;\n    margin-bottom: 20px;\n    line-height: 1.6;\n    color: #ccc;\n}\n\n#win-screen .highlight {\n    color: #88ff88;\n    font-weight: bold;\n    font-size: 22px;\n    margin-top: 20px;\n    text-shadow: 0 0 5px rgba(136, 255, 136, 0.3);\n}\n\n#win-screen .press-key {\n    margin-top: 50px;\n    font-size: 20px;\n    color: #fff;\n    animation: pulse 1.5s infinite;\n}\nEOF\n"
			],
			"isBackground": false,
			"problemMatcher": [],
			"group": "none"
		},
		{
			"label": "append_settings_css",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"cat >> style.css <<EOF\n\n#settings-menu {\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background: rgba(0, 0, 0, 0.85);\n    border: 2px solid #666;\n    padding: 20px;\n    color: #eee;\n    z-index: 1000;\n    width: 300px;\n    border-radius: 10px;\n    box-shadow: 0 0 20px rgba(0,0,0,0.8);\n}\n\n#settings-menu h2 {\n    text-align: center;\n    margin-top: 0;\n    color: #ffaa00;\n    border-bottom: 1px solid #444;\n    padding-bottom: 10px;\n}\n\n.slider-container {\n    margin: 15px 0;\n    display: flex;\n    flex-direction: column;\n}\n\n.slider-container label {\n    margin-bottom: 5px;\n    font-weight: bold;\n}\n\n.slider-container input {\n    width: 100%;\n    cursor: pointer;\n}\n\n.slider-container span {\n    text-align: right;\n    font-size: 12px;\n    color: #aaa;\n    margin-top: 2px;\n}\nEOF\n"
			],
			"group": "none"
		},
		{
			"label": "append_ui_js",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"cat >> ui.js <<EOF\n\nexport function initSettings() {\n    const menu = document.getElementById('settings-menu');\n    const brightnessSlider = document.getElementById('brightness-slider');\n    const contrastSlider = document.getElementById('contrast-slider');\n    const distanceSlider = document.getElementById('distance-slider');\n    \n    const brightnessVal = document.getElementById('brightness-val');\n    const contrastVal = document.getElementById('contrast-val');\n    const distanceVal = document.getElementById('distance-val');\n    \n    if (!menu) return;\n\n    const updateVisuals = () => {\n        const b = brightnessSlider.value;\n        const c = contrastSlider.value;\n        const d = distanceSlider.value;\n        \n        brightnessVal.textContent = b;\n        contrastVal.textContent = c;\n        distanceVal.textContent = d;\n        \n        // Apply CSS filters for brightness/contrast\n        if (game.renderer && game.renderer.domElement) {\n            game.renderer.domElement.style.filter = \\`brightness(\\${b}) contrast(\\${c})\\`;\n        }\n        \n        // Apply fog distance\n        if (game.scene && game.scene.fog) {\n            game.scene.fog.far = parseFloat(d);\n        }\n    };\n\n    brightnessSlider.addEventListener('input', updateVisuals);\n    contrastSlider.addEventListener('input', updateVisuals);\n    distanceSlider.addEventListener('input', updateVisuals);\n}\n\nexport function toggleSettings() {\n    const menu = document.getElementById('settings-menu');\n    if (menu) {\n        if (menu.style.display === 'none') {\n            menu.style.display = 'block';\n            // Sync slider with current fog if needed\n            if (game.scene && game.scene.fog) {\n                const distanceSlider = document.getElementById('distance-slider');\n                if (distanceSlider) {\n                     distanceSlider.value = game.scene.fog.far;\n                     const valDisplay = document.getElementById('distance-val');\n                     if (valDisplay) valDisplay.textContent = Math.round(game.scene.fog.far);\n                }\n            }\n        } else {\n            menu.style.display = 'none';\n        }\n    }\n}\nEOF\n"
			],
			"group": "none"
		},
		{
			"label": "append_journal_css",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"\ncat >> style.css <<EOF\n\n/* Journal Styles */\n@import url('https://fonts.googleapis.com/css2?family=Homemade+Apple&display=swap');\n\n#journal-book {\n    background: #fdf6e3; /* Fallback */\n    background: radial-gradient(#fffef0, #f0e6c0);\n    border: 1px solid #d4c5a0;\n    box-shadow: \n        inset 0 0 30px rgba(0,0,0,0.1),\n        0 0 20px rgba(0,0,0,0.5),\n        5px 10px 15px rgba(0,0,0,0.3);\n    color: #432;\n    transform: rotate(-1deg);\n    position: relative;\n    font-family: 'Homemade Apple', cursive;\n}\n\n#journal-book::before {\n    content: \"\";\n    position: absolute;\n    top: 0; left: 0; width: 100%; height: 100%;\n    background: \n        url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\"><filter id=\"noise\"><feTurbulence type=\"fractalNoise\" baseFrequency=\"0.5\" numOctaves=\"3\" stitchTiles=\"stitch\"/></filter><rect width=\"100%\" height=\"100%\" filter=\"url(%23noise)\" opacity=\"0.05\"/></svg>'),\n        linear-gradient(to right, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0) 5%, rgba(0,0,0,0) 95%, rgba(0,0,0,0.1) 100%);\n    pointer-events: none;\n    z-index: 1;\n}\n\n/* Water stains */\n.water-stain {\n    position: absolute;\n    border-radius: 50%;\n    background: radial-gradient(circle, rgba(160, 180, 200, 0) 40%, rgba(160, 180, 200, 0.1) 50%, rgba(160, 180, 200, 0.05) 70%, rgba(160, 180, 200, 0) 100%);\n    pointer-events: none;\n    z-index: 2;\n}\n\n/* Blood stains */\n.blood-stain {\n    position: absolute;\n    background-color: rgba(139, 0, 0, 0.4);\n    border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;\n    filter: blur(2px);\n    pointer-events: none;\n    z-index: 2;\n    mix-blend-mode: multiply;\n}\n\n.blood-splatter {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: #800;\n    border-radius: 50%;\n    opacity: 0.7;\n    pointer-events: none;\n    z-index: 2;\n}\n\n.journal-entry {\n    position: relative;\n    padding: 20px;\n    margin-bottom: 20px;\n    border-bottom: 2px dashed #dcb;\n}\n\n.journal-entry h3 {\n    font-family: 'Times New Roman', serif;\n    font-variant: small-caps;\n    border-bottom: 1px solid #a98;\n    padding-bottom: 5px;\n    display: inline-block;\n}\n\n.journal-date {\n    font-size: 0.8em;\n    color: #865;\n    position: absolute;\n    top: 20px;\n    right: 20px;\n    font-family: sans-serif;\n}\nEOF\n"
			],
			"isBackground": false,
			"group": "none"
		}
	]
}